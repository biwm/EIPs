(window.webpackJsonp=window.webpackJsonp||[]).push([[261],{661:function(e,t,a){"use strict";a.r(t);var i=a(46),r=Object(i.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"simple-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[e._v("#")]),e._v(" Simple Summary")]),e._v(" "),a("p",[e._v("In the context of Computation Integrity Proof (CIP) Layer-2 solutions such as ZK-Rollups, users are required to sign messages on new elliptic curves optimized for those environnements. We leverage existing work on Key Derivation ("),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP32"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP39"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP44"),a("OutboundLink")],1),e._v(") to define an efficient way to securely produce CIP L2s private keys, as well as creating domain separation between Layer-2 applications.")]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("We provide a Derivation Path allowing a user to derive hierarchical keys for Layer-2 solutions depending on the zk-technology, the application, the userâ€™s Layer-1 address, as well as an efficient grinding method to enforce the private key distribution within the curve domain. The propose Derivation Path is defined as follow")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("m / purpose' / layer' / application' / eth_address_1' / eth_address_2' / index\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("In the context of Computation Integrity Proof (CIP) Layer-2 solutions such as ZK-Rollups, users are required to sign messages on new elliptic curves optimized for those environnements. Extensive work has been done to make it secure on Bitcoin via "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP32"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP39"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP44"),a("OutboundLink")],1),e._v(". Those protosals have become the standard for wallets in the entire industry, independently on the associated blockchain. As Layer-2 solutions are taking off, it is a necessary requirement to maintain the same standard and security in this new space.")]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("p",[e._v("Starkware keys are derived with the following "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP43"),a("OutboundLink")],1),e._v("-compatible derivation path, with direct inspiration from "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP44"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("m / purpose' / layer' / application' / eth_address_1' / eth_address_2' / index\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("where:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("m")]),e._v(" - the seed.")]),e._v(" "),a("li",[a("code",[e._v("purpose")]),e._v(" - "),a("code",[e._v("2645")]),e._v(" (the number of this EIP).")]),e._v(" "),a("li",[a("code",[e._v("layer")]),e._v(" - the 31 lowest bits of sha256 on the layer name. Serve as a domain separator between different technologies. In the context of "),a("code",[e._v("starkex")]),e._v(", the value would be "),a("code",[e._v("579218131")]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("application")]),e._v(" - the 31 lowest bits of sha256 of the application name. Serve as a domain separator between different applications. In the context of DeversiFi in June 2020, it is the 31 lowest bits of sha256(starkexdvf) and the value would be "),a("code",[e._v("1393043894")]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("eth_address_1 / eth_address_2")]),e._v(" - the first and second 31 lowest bits of the corresponding eth_address.")]),e._v(" "),a("li",[a("code",[e._v("index")]),e._v(" - to allow multiple keys per eth_address.")])]),e._v(" "),a("p",[e._v("As example, the expected path for address 0x0000....0000 assuming seed "),a("code",[e._v("m")]),e._v(" and index 0 in the context of DeversiFi in June 2020: "),a("code",[e._v("m/2645'/579218131'/1393043894'/0'/0'/0")])]),e._v(" "),a("p",[e._v("The key derivation should follow the following algorithm")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("N = 2**256\nn = Layer2 curve order\t\t\t\t\t\t\t\t\npath = stark derivation path\nBIP32() = Official BIP-0032 derivation function on secp256k1\nhash = SHA256\ni = 0\nroot_key = BIP32(path)\nwhile True:\n\tkey = hash(root_key|i)\n\tif (key < (N - (N % n))):\n\t\treturn key % n\n\ti++\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("p",[e._v("This algorithm has been defined to maintain efficiency on existing restricted devices.")]),e._v(" "),a("p",[e._v("Nota Bene: At each round, the probability for a key to be greater than (N - (N % n)) is < 2^(-5).")]),e._v(" "),a("h2",{attrs:{id:"rationale"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[e._v("#")]),e._v(" Rationale")]),e._v(" "),a("p",[e._v("This EIP specifies two aspects of keys derivation in the context of Hierarchical Wallets:")]),e._v(" "),a("ul",[a("li",[e._v("Derivation Path")]),e._v(" "),a("li",[e._v("Grinding Algorithm to enforce a uniform distribution over the elliptic curve.\nThe derivation path is defined to allow efficient keys separation based on technology and application while maintaining a 1-1 relation with the Layer-1 wallet. In such a way, losing EIP-2645 wallets falls back to losing the Layer-1 wallet.")])]),e._v(" "),a("h2",{attrs:{id:"backwards-compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backwards-compatibility"}},[e._v("#")]),e._v(" Backwards Compatibility")]),e._v(" "),a("p",[e._v("This standard complies with BIP43.")]),e._v(" "),a("h2",{attrs:{id:"security-considerations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security-considerations"}},[e._v("#")]),e._v(" Security Considerations")]),e._v(" "),a("p",[e._v("This EIP has been defined to maintain separation of keys while providing foolproof logic on key derivation.")]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("Copyright and related rights waived via "),a("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CC0"),a("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=r.exports}}]);