(window.webpackJsonp=window.webpackJsonp||[]).push([[584],{999:function(e,t,a){"use strict";a.r(t);var n=a(46),o=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"simple-summary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simple-summary"}},[e._v("#")]),e._v(" Simple Summary")]),e._v(" "),a("p",[e._v("Creation of new accounts (both contracts and non-contracts) requires a fixed one-off rent prepayment. Pre-existed accounts require the same prepayment upon the first modification. The act of rent prepayment causes the addition of an extra field to accounts, called "),a("code",[e._v("rentbalance")]),e._v(". This field becomes part of state.")]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("This is part of the State Rent roadmap. This particular change introduces a fixed charge for state expansion that comes from adding new accounts to the state. Theoretically, it puts a bound on the number of accounts that can be ever created, because that fixed charge cannot be recycled via mining.")]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("The penalty is levied to the transaction sender. Rather than raising the gas cost of account creation (that would direct levy towards the miner), this change directs prepayment into the account's special field, "),a("code",[e._v("rentbalance")]),e._v(". It addresses several shortcomings of the simple raising of the gas cost:")]),e._v(" "),a("ol",[a("li",[e._v("Prepayments cannot be recycled via mining, which puts a theoretical bound on number of accounts in the state (though it is unlikely to ever be reached).")]),e._v(" "),a("li",[e._v("It is not possible for miners to circumvent the penalty or to extend such circumventions onto other users (via private fee rebates, for example).")]),e._v(" "),a("li",[e._v("This prepayment will be used to cover state rent in the future, and it will allow newly created contracts with 0 endowment not to be evicted in the same block.")]),e._v(" "),a("li",[e._v("It makes is possible to refund "),a("code",[e._v("rentbalance")]),e._v(" upon self-destruction - when contract is self-destructed, both "),a("code",[e._v("balance")]),e._v(" and "),a("code",[e._v("rentbalance")]),e._v(" are returned.")]),e._v(" "),a("li",[e._v("Prepayments on pre-existing accounts are necessary to prevent hoarding of accounts ahead of this change.")])]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("p",[e._v("On and after block "),a("code",[e._v("H")]),e._v(", every newly created account gets a new field "),a("code",[e._v("rentbalance")]),e._v(" of type unsigned 256-bit integer. On and after block "),a("code",[e._v("H")]),e._v(", any operation that leads to the creation of a new account, deducts the amount "),a("code",[e._v("ACCOUNT_PREPAYMENT")]),e._v(" from "),a("code",[e._v("tx.origin")]),e._v(". This amount is added to the "),a("code",[e._v("rentbalance")]),e._v(" field of the created account. On and after block "),a("code",[e._v("H")]),e._v(", any operation that modifies an account that does not yet have "),a("code",[e._v("rentbalance")]),e._v(" field, deducts the amount "),a("code",[e._v("ACCOUNT_PREPAYEMENT")]),e._v(" from "),a("code",[e._v("tx.origin")]),e._v(". This amount is added to the "),a("code",[e._v("rentbalance")]),e._v(" field of the modified account. This is a anti-hoarding measure.")]),e._v(" "),a("p",[e._v("Operations leading to the creations of a new account:")]),e._v(" "),a("ol",[a("li",[e._v("Creation of a non-contract account by sending non-zero ETH to an address with no associated account")]),e._v(" "),a("li",[e._v("Creation of a non-contract account by the block with "),a("code",[e._v("coinbase")]),e._v(" pointing to an address with no associated account")]),e._v(" "),a("li",[e._v("Creation of a non-contract account by "),a("code",[e._v("SELFDESTRUCT")]),e._v(" with the argument being an address with no associated account")]),e._v(" "),a("li",[e._v("Creation of a contract by transaction without destination but with data. This can result in either converting a non-countract account into a contract account, or creation of a contract account.")]),e._v(" "),a("li",[e._v("Creation of a contract by execution of "),a("code",[e._v("CREATE")]),e._v(" or "),a("code",[e._v("CREATE2")]),e._v(". This can result in either converting a non-countract account into a contract account, or creation of a contract account.")])]),e._v(" "),a("p",[e._v("After prepayments are introduced, there can be two reasons for ether to be deducted from "),a("code",[e._v("tx.origin")]),e._v(": purchasing and spending gas, and spending gas for prepayments. Gaslimit of a transaction currently plays a role of safety limit, where "),a("code",[e._v("gaslimit")]),e._v("  * "),a("code",[e._v("gasprice")]),e._v(" represents the maximum amount of wei the sender ("),a("code",[e._v("tx.origin")]),e._v(") authorises the transaction to deduct from its account. After prepayments are introduced, "),a("code",[e._v("gaslimit")]),e._v(" * "),a("code",[e._v("gasprice")]),e._v(" will still represent the maximum amount of wei spend, but it will be used for both gas purchases and prepayments, as necessary.")]),e._v(" "),a("h2",{attrs:{id:"rationale"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[e._v("#")]),e._v(" Rationale")]),e._v(" "),a("p",[e._v("Prior to rent prepayments, other alternatives were considered:")]),e._v(" "),a("ol",[a("li",[e._v("Simple raising of the gas cost - discussed in the Motivation section.")]),e._v(" "),a("li",[e._v("In "),a("a",{attrs:{href:"https://github.com/ledgerwatch/eth_state/blob/master/State_rent.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("first version of State Rent proposal"),a("OutboundLink")],1),e._v(", there was no notion of extra levy upon account creation. It created a slight usability issue, where newly created contracts with 0 endowment would be evicted in the same block (when rent is introduced). It delays the benefits of the State Rent programme until the actual introduction of rent (in second or third hard-fork).")]),e._v(" "),a("li",[e._v("In the "),a("a",{attrs:{href:"https://github.com/ledgerwatch/eth_state/blob/master/State_Rent_2.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("second version of State Rent proposal"),a("OutboundLink")],1),e._v(", there was a notion of lock-up. It is very similar to rent prepayment, with the different that lock-up would not be covering future rent payments.")])]),e._v(" "),a("p",[e._v("An alternative approach to limiting the prepayments (instead of the using "),a("code",[e._v("gaslimit")]),e._v(" * "),a("code",[e._v("gasprice")]),e._v(" as the limit) is to introduce a new dedicated field "),a("code",[e._v("prepaymenlimit")]),e._v(" into the transaction. This field would only limit prepayments). Such approach would require changes in the transaction format, as well as changes in the user interface for transaction sender, and having two counters during the transaction execution - one for gas, and one for prepayments.")]),e._v(" "),a("h2",{attrs:{id:"backwards-compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backwards-compatibility"}},[e._v("#")]),e._v(" Backwards Compatibility")]),e._v(" "),a("p",[e._v("This change is not backwards compatible and requires hard fork to be activated. It might have some adverse effects on the existing contracts, due to more gas needed to be allocated for the creation of new accounts. These adverse effects need to analysed in more detail.")]),e._v(" "),a("h2",{attrs:{id:"test-cases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-cases"}},[e._v("#")]),e._v(" Test Cases")]),e._v(" "),a("p",[e._v("Tests cases will be generated out of a reference implementation.")]),e._v(" "),a("h2",{attrs:{id:"implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#implementation"}},[e._v("#")]),e._v(" Implementation")]),e._v(" "),a("p",[e._v("There will be proof of concept implementation to refine and clarify the specification.")]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("Copyright and related rights waived via "),a("a",{attrs:{href:"https://creativecommons.org/publicdomain/zero/1.0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CC0"),a("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=o.exports}}]);